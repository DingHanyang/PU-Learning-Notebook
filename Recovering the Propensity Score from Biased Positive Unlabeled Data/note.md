两组假设：

1. 第一组假设不对倾向评分的函数形式作任何假设（需要对数据分布作出假设）
2. 第二组假设放宽了对数据的假设，同时假设倾向评分具有某种函数形式

虽然之前有一项研究也试图学习这种标记机制（Bekker、Robberechts和Davis 2019），称为倾向评分，但它没有关注可识别性。因此，不清楚这种方法何时会返回真实的倾向评分，何时返回的值可能会几乎任意不正确

# 1 Local Certainty Propensity Estimation

我们首先将倾向评分 $e$ 表示为正类分布和标记分布的函数：

1. **初始定义**：
   $ e = p(\ell = 1 \mid x, y = 1) $
   这表示给定 $x$ 和 $y = 1$ 的情况下，被标记为正类的概率。

2. **使用联合概率分解**：
   $ e = \frac{p(\ell = 1 \mid x, y = 1) p(x, y = 1)}{p(x, y = 1)} $
   这里我们乘以 $p(x, y = 1)$ 然后再除以它，以便引入联合概率的形式。

3. **联合概率的分解**：
   $ e = \frac{p(\ell = 1, x, y = 1)}{p(x, y = 1)} $
   联合概率 $p(\ell = 1, x, y = 1)$ 表示 $x$ 和 $y = 1$ 并且被标记为正类的概率。

4. **利用边缘概率分解**：
   $ e = \frac{p(\ell = 1, x)}{p(x, y = 1)} $
   这里我们利用边缘概率 $p(\ell = 1, x)$ 来表示联合概率。

5. **引入条件概率和边缘概率**：
   $ e = \frac{p(\ell = 1) p(x \mid \ell = 1)}{p(y = 1) p(x \mid y = 1)} $
   将边缘概率和条件概率结合，分子为 $p(\ell = 1)$ 和 $p(x \mid \ell = 1)$，分母为 $p(y = 1)$ 和 $p(x \mid y = 1)$。

6. **问题出现**：
   这一步我们发现，虽然我们可以从 $p(x \mid \ell = 1)$ 采样，但无法从 $p(x \mid y = 1)$ 采样，因为 $p(y = 1)$ 在我们的有偏PU数据中无法直接估计。

我们建议用 $p(x) / p(y = 1)$ 代替公式中的 $p(x \mid y = 1)$：

- **公式替代**：
  $ e^* = \frac{p(\ell = 1) p(x \mid \ell = 1)}{p(x)} $

这个替代方案的逻辑如下：

1. **$p(x)$ 的表示**：
   $ p(x) = p(y = 1) p(x \mid y = 1) + (1 - p(y = 1)) p(x \mid y = 0) $
   这是 $x$ 的总体概率，包含正类和负类的概率加权。

2. **在局部确定性假设下**：
   - 对于正类实例 $x$，$p(x \mid y = 0) = 0$，因为正类和负类完全分离。
   - 因此，$p(x) = p(y = 1) p(x \mid y = 1)$。

3. **替换推导**：
   $ p(x \mid y = 1) = \frac{p(x)}{p(y = 1)} $
   因此，我们可以将 $p(x \mid y = 1)$ 替换为 $\frac{p(x)}{p(y = 1)}$，从而简化计算。

4. **最终替代公式**：
   这意味着我们可以用 $\frac{p(x)}{p(y = 1)}$ 替换 $p(x \mid y = 1)$ 得到：
   $ e^* = \frac{p(\ell = 1) p(x \mid \ell = 1)}{p(x)} $

